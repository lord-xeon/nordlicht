//JSONtip v1.0 (c)2011 stephen giorgi licensed under GNU GPL v2
(function(a){a.fn.JSONtip=function(c){var b={fadeInSpeed:500,fadeOutSpeed:200,xOffSet:12,yOffSet:12,tipPosition:"right",autoPosition:true,bodyClose:true,tipClass:"",json:null,jsonData:null,inlineParse:false};var c=a.extend(b,c);makeTip=function(){var d='<div class="JSONtip tipRight '+b.tipClass+'"><span class="JSONtipClose">x</span><div class="JSONtipArrow"><div class="inArrow"></div></div></span><h4></h4><p class="JSONtipBody"></p></div>';return d};if(a(".JSONtip").length==0){a("body").append(makeTip())}return this.each(function(){var q=a(this),d=a("body").data("timer"),o=a(".JSONtip"),j=o.css("display"),i=a(".JSONtip h4"),r=a(".JSONtip .JSONtipBody"),n=a(".JSONtip .JSONtipArrow"),g=q.offset(),l=g.top,p=g.left,m=q.outerHeight(),e=q.outerWidth(),k=q.data();if(b.json){f()}q.click(function(s){s.preventDefault();s.stopPropagation();r.html(tipFill(this,k,"body"));i.html(tipFill(this,k,"head"));tipPlace(m,e,this);tipShow(this)});o.click(function(s){s.stopPropagation()});a("body").keyup(function(s){if(s.keyCode==27){h()}});if(b.bodyClose==true){a("body").click(function(){h()})}a(".JSONtipClose").click(function(){h()});tipFill=function(u,v,t){var s="",w=a(u).data();if(t=="body"){if(w.json){s=w.json.tipbody}else{if(v.tipbody){s=v.tipbody}else{s=u.title}}}else{if(w.json){s=w.json.tiphead}else{if(v.tipbody){s=v.tiphead}}}return s};isHeader=function(){var s="block";if(i.html()==""){s="none"}i.css({display:s})};tipPlace=function(y,z,x){var A=o.height(),w=b.xOffSet,u=b.yOffSet,C=a(x).offset(),v=(z+C.left)+w,s=(C.top)-u,B=b.tipPosition.toLowerCase();if(b.inlineParse==true){var t=a(x).data();if(t.tipposition){B=t.tipposition.toLowerCase()}if(t.xoffset){w=t.xoffset}if(t.yoffset){u=t.yoffset}}o.removeClass().addClass("JSONtip tipRight "+b.tipClass);switch(B){case"left":v=(C.left-o.width())-w;o.removeClass("tipRight").addClass("tipLeft");break;case"topleft":v=(C.left)+w;s=(C.top-A)-u;o.removeClass("tipRight").addClass("tipTopLeft");break;case"topright":v=(C.left-o.width())+z-w;s=(C.top-A)-u;o.removeClass("tipRight").addClass("tipTopRight");break;case"topcenter":v=(C.left+z/2)-(o.width()/2)-w;s=(C.top-A)-u;o.removeClass("tipRight").addClass("tipTopCenter");break;case"bottomleft":v=(C.left)+w;s=(C.top+y)+u;o.removeClass("tipRight").addClass("tipBottomLeft");break;case"bottomright":v=(C.left-o.width())+z-w;s=(C.top+y)+u;o.removeClass("tipRight").addClass("tipBottomRight");break;case"bottomcenter":v=(C.left+z/2)-(o.width()/2)-w;s=(C.top+y)+u;o.removeClass("tipRight").addClass("tipBottomCenter");break;default:v=(C.left+z)+w;break}o.css({top:s,left:v,dispaly:"block"})};tipMovePos=function(C){var v=b.autoPosition;if(a(C).data("autoposition")!=b.autoPosition){if(a(C).data("autoposition")==true||a(C).data("autoposition")==false){v=a(C).data("autoposition")}}if(v==false){return}var A=o.offset(),F=A.left,D=A.top,t=window.innerWidth,x=window.innerHeight,G=o.outerWidth(),z=o.outerHeight(),s=A.left+G,u=F,E=A.top+z,H=D,B=b.xOffSet,y=b.yOffSet;if(b.inlineParse==true){var w=a(C).data();if(w.xoffset){B=w.xoffset}if(w.yoffset){y=w.yoffset}}if(s>t){F=(p-G)-B;if(o.hasClass("tipBottomLeft")){F=(p-G)+B;o.removeClass("tipBottomLeft").addClass("tipBottomRight")}else{if(o.hasClass("tipTopLeft")){F=(p-G)+B;o.removeClass("tipTopLeft").addClass("tipTopRight")}else{if(o.hasClass("tipRight")){o.removeClass("tipRight").addClass("tipLeft")}}}}else{if(F<0){F=(C.offsetWidth-B);if(o.hasClass("tipTopRight")){o.removeClass("tipTopRight").addClass("tipTopLeft")}else{if(o.hasClass("tipBottomRight")){o.removeClass("tipBottomRight").addClass("tipBottomLeft")}else{if(o.hasClass("tipLeft")){F=(C.offsetWidth+e+B);o.removeClass("tipLeft").addClass("tipRight")}}}}}o.css({left:F,top:D})};tipShow=function(s){isHeader();o.css({zIndex:9000,display:"block"});tipMovePos(s);o.fadeIn(b.fadeInSpeed)};function h(){o.fadeOut(b.fadeOutSpeed)}function f(){var t=k.code?k.code:b.jsonData,s=b.json;a.getJSON(s,{code:t},function(u){q.data("json",u)})}})}})(jQuery,document,this);